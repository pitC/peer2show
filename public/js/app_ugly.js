define(["jquery","underscore","backbone","backbones/views/roomView","backbones/views/homepageView","app/settings","app/logManager"],function(e,o,n,s,i,t,l){var a=n.Router.extend({initialize:function(e){this.el=e.el,l.switchConsoleLogs(t.enableConsoleLog),console.log("App Router init!")},routes:{"":"homepage",":roomId":"room"},homepage:function(){console.log("Render homepage..."),this.loadHomepage(!1)},room:function(e){if(console.log("Inp room ID "+e),t.owner||t.userName){var o={roomId:location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),user:t.userName,owner:t.owner};this.initRoom(o)}else this.loadHomepage(!0)},loadHomepage:function(e){this.el.empty();var o={guest:e,rootEl:this.el,callback:this.initRoom},n=new i(o);this.el.empty(),this.el.append(n.render().el),n.onShow()},initRoom:function(o){console.log("init room "+o.user+" "+o.roomId+" is owner?"+o.owner);var n=this.el||this.$el;e(n).empty();var i=new s(o);e(n).html(i.render().el),e(".landing-page-style").removeClass("landing-page-style").addClass("session-style"),e(".session-end-style").removeClass("session-end-style").addClass("session-style"),i.onShow()}}),r=function(){new a({el:e("#content")}),n.history.start()};return{initialize:r}});